[gd_scene load_steps=29 format=3 uid="uid://yyd0ltle0un5"]

[ext_resource type="PackedScene" uid="uid://e0k8h1ytp7wi" path="res://lib/ui/hud/hud.tscn" id="1_3q1w7"]
[ext_resource type="Script" path="res://maps/test/test.gd" id="1_fvnbx"]
[ext_resource type="PackedScene" uid="uid://bcp4um4sjbyx6" path="res://lib/player/player.tscn" id="1_wua70"]
[ext_resource type="Texture2D" uid="uid://bd7c4x2ajeimr" path="res://generic/tex/shader_tex/floor_diff.png" id="2_3dm53"]
[ext_resource type="Texture2D" uid="uid://dinrdf02xeqaq" path="res://generic/tex/fade_ramp.tres" id="2_qqlgb"]
[ext_resource type="Texture2D" uid="uid://d1fy6jygommc6" path="res://generic/tex/particles/mote.png" id="3_hvkgi"]
[ext_resource type="Texture2D" uid="uid://c5duom5wl7px7" path="res://generic/tex/sky.png" id="3_mt7r7"]
[ext_resource type="Texture2D" uid="uid://5bruu4afeor5" path="res://generic/tex/shader_tex/floor_norm.png" id="3_xldvb"]
[ext_resource type="PackedScene" uid="uid://d3wu1w4amd36m" path="res://objects/insight/insight.tscn" id="12_sl0pd"]
[ext_resource type="PackedScene" uid="uid://k05mh66k8gs8" path="res://objects/puzzle_piece/lever.tscn" id="13_ix5rb"]
[ext_resource type="PackedScene" uid="uid://bw14qvqobtubd" path="res://characters/fourier/fourier.glb" id="13_r7xks"]
[ext_resource type="Script" path="res://lib/ui/screen_space_label/screen_space_label.gd" id="15_b7hap"]
[ext_resource type="PackedScene" uid="uid://bvnmyltvk8rhe" path="res://lib/cond_dialogue/cond_dialogue.tscn" id="15_j3rmr"]
[ext_resource type="PackedScene" uid="uid://djgjcyichaft4" path="res://objects/rocket/rocket.glb" id="16_syt88"]
[ext_resource type="AudioStream" uid="uid://c62xqceplif7s" path="res://maps/lattice/sounds/lava_ambience.ogg" id="17_ifxop"]
[ext_resource type="Script" path="res://lib/debug/debug_flag/debug_flag.gd" id="18_fje8s"]
[ext_resource type="Texture2D" uid="uid://chb02gji54q0j" path="res://lib/debug/debug_flag/tex/controller_icon.png" id="19_1pd7c"]

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_lvxdd"]
panorama = ExtResource("3_mt7r7")

[sub_resource type="Sky" id="Sky_aq0yt"]
sky_material = SubResource("PanoramaSkyMaterial_lvxdd")

[sub_resource type="Environment" id="Environment_ni4hb"]
background_mode = 2
sky = SubResource("Sky_aq0yt")
ambient_light_source = 2
ambient_light_color = Color(0.809309, 0.762095, 0.721323, 1)
ambient_light_energy = 1.3
tonemap_mode = 2
tonemap_exposure = 2.0
glow_levels/5 = 0.1
fog_enabled = true
fog_light_color = Color(0, 0, 0, 1)
fog_density = 0.03
fog_sky_affect = 0.0
fog_height = 25.0
fog_height_density = -0.1
volumetric_fog_enabled = true
volumetric_fog_density = 0.04
volumetric_fog_albedo = Color(0.5, 0.331583, 0.265, 1)
volumetric_fog_length = 8.0
adjustment_enabled = true
adjustment_brightness = 1.1
adjustment_saturation = 1.2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_bhgh8"]
albedo_color = Color(0.509286, 0.509286, 0.509286, 1)
albedo_texture = ExtResource("2_3dm53")
normal_enabled = true
normal_scale = 2.0
normal_texture = ExtResource("3_xldvb")
backlight = Color(0.25, 0.25, 0.25, 1)
uv1_scale = Vector3(128, 128, 128)

[sub_resource type="QuadMesh" id="QuadMesh_ixi6y"]
material = SubResource("StandardMaterial3D_bhgh8")
size = Vector2(200, 200)
orientation = 1

[sub_resource type="BoxShape3D" id="BoxShape3D_ofh4r"]
size = Vector3(200, 0.1, 200)

[sub_resource type="Curve" id="Curve_hi6aq"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_exr7w"]
curve = SubResource("Curve_hi6aq")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_xa72n"]
emission_shape = 3
emission_box_extents = Vector3(5, 5, 5)
initial_velocity_min = 0.05
initial_velocity_max = 0.05
gravity = Vector3(0, 0.01, 0)
scale_min = 0.5
scale_curve = SubResource("CurveTexture_exr7w")
color_ramp = ExtResource("2_qqlgb")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_b4sji"]
transparency = 1
cull_mode = 2
vertex_color_use_as_albedo = true
albedo_texture = ExtResource("3_hvkgi")
backlight_enabled = true
backlight = Color(1, 1, 1, 1)
billboard_mode = 3
particles_anim_h_frames = 1
particles_anim_v_frames = 1
particles_anim_loop = false

[sub_resource type="PlaneMesh" id="PlaneMesh_k7b7a"]
material = SubResource("StandardMaterial3D_b4sji")
size = Vector2(0.06, 0.06)
orientation = 2

[node name="Test" type="Node3D"]
script = ExtResource("1_fvnbx")
map_name = "test"
custom_data_load_signal = true

[node name="HUD" parent="." instance=ExtResource("1_3q1w7")]

[node name="Sky" type="WorldEnvironment" parent="."]
unique_name_in_owner = true
environment = SubResource("Environment_ni4hb")

[node name="Sun" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.258819, -0.836516, 0.482963, 0, 0.5, 0.866025, -0.965926, -0.224144, 0.12941, 0, 6, 0)
light_energy = 2.0
light_bake_mode = 1
shadow_enabled = true
directional_shadow_split_1 = 0.3
directional_shadow_split_2 = 0.4
directional_shadow_split_3 = 0.7
directional_shadow_blend_splits = true
directional_shadow_pancake_size = 10.0
sky_mode = 1

[node name="Player" parent="." instance=ExtResource("1_wua70")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4, 5)

[node name="Insights" type="Node3D" parent="."]
unique_name_in_owner = true

[node name="Insight" parent="Insights" instance=ExtResource("12_sl0pd")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -10)
object_name = "insight_1"
dialogue_data = Array[String](["Test dialogue!"])

[node name="Insight2" parent="Insights" instance=ExtResource("12_sl0pd")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -20)
object_name = "insight_2"
dialogue_data = Array[String](["Test dialogue!"])

[node name="Floor" type="StaticBody3D" parent="."]
collision_layer = 3

[node name="Mesh" type="MeshInstance3D" parent="Floor"]
mesh = SubResource("QuadMesh_ixi6y")
skeleton = NodePath("../..")

[node name="Collision" type="CollisionShape3D" parent="Floor"]
shape = SubResource("BoxShape3D_ofh4r")

[node name="Motes" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)
cast_shadow = 0
amount = 20
lifetime = 3.0
preprocess = 5.0
speed_scale = 0.5
visibility_aabb = AABB(-6.5899, -2.60607, -5.6187, 13.1798, 5.21214, 11.2374)
process_material = SubResource("ParticleProcessMaterial_xa72n")
draw_pass_1 = SubResource("PlaneMesh_k7b7a")

[node name="Ambience" type="AudioStreamPlayer" parent="."]
stream = ExtResource("17_ifxop")
volume_db = -7.0
autoplay = true

[node name="SavePoints" type="Node3D" parent="."]
unique_name_in_owner = true

[node name="SP" type="Marker3D" parent="SavePoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 3)
script = ExtResource("18_fje8s")
custom_texture = ExtResource("19_1pd7c")

[node name="LeverA" parent="." instance=ExtResource("13_ix5rb")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 0, -3)
lever_name = "lever_a"

[node name="AVis" type="VisibleOnScreenNotifier3D" parent="LeverA"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
aabb = AABB(-0.5, -0.5, -0.5, 1, 1, 1)
script = ExtResource("15_b7hap")
display_text = "Lever A"
render_distance = 20

[node name="LeverB" parent="." instance=ExtResource("13_ix5rb")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, -3)
lever_name = "lever_b"

[node name="BVis" type="VisibleOnScreenNotifier3D" parent="LeverB"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 0)
aabb = AABB(-0.5, -0.5, -0.5, 1, 1, 1)
script = ExtResource("15_b7hap")
display_text = "Lever B"
render_distance = 20

[node name="LeverJedi" parent="." instance=ExtResource("13_r7xks")]
transform = Transform3D(1.3, 0, 0, 0, 1.3, 0, 0, 0, 1.3, 0, 2.4, -2)

[node name="Vis" type="VisibleOnScreenNotifier3D" parent="LeverJedi"]
transform = Transform3D(0.769231, 0, 0, 0, 0.769231, 0, 0, 0, 0.769231, 0, 1.3, 0)
aabb = AABB(-0.5, -0.5, -0.5, 1, 1, 1)
script = ExtResource("15_b7hap")
display_text = "\"Lever Jedi\""
render_distance = 20

[node name="DLeverJedi" parent="LeverJedi" instance=ExtResource("15_j3rmr")]
transform = Transform3D(0.769231, 0, 0, 0, 0.769231, 0, 0, 0, 0.769231, 0, 0, 0)
object_name = "lever_dialogue"
dialogue_data_file = "res://maps/test/d_lever_jedi.json"

[node name="Rocket" parent="." instance=ExtResource("16_syt88")]
transform = Transform3D(0.707107, 0, 0.707107, 0, 1, 0, -0.707107, 0, 0.707107, -20, 18, -16)

[connection signal="state_set" from="LeverA" to="." method="_on_lever_a_state_set"]
[connection signal="state_set" from="LeverB" to="." method="_on_lever_b_state_set"]
